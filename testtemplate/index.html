<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
	<link rel="stylesheet" href="semantic.css">
	<link rel="stylesheet" href="icon.css">
	<link rel="stylesheet" href="main.css">
</head>
<body>


	<div class="main container">
		<div class="ui grid">

			<!-- Header -->
			<div class="row">
				<div class="twelve wide column">
					<h1>Protractor E2E Coverage</h1>
				</div>
				<div class="four wide column">
					<div class="ui two item menu">
						<a href="https://www.npmjs.com/package/protractor-e2e-coverage" class="item">
							Npm
						</a>
						<a href="https://github.com/markuswaltre/protractor-e2e-coverage" class="item">
							Github
						</a>
					</div>
				</div>
			</div>


<!-- 			<div class="row">
				View config
			</div>
 -->
			<div id="statistics" class="row"></div>
			
			<h3>Coverage by element type</h3>
			<div id="statistics_types" class="row"></div>


			<h3>States</h3>
			<div id="states" class="row"></div>

		</div>


	</div>

	

	<!-- <div id="types" style="display: none;"></div> -->
	<!-- <div id="statistics"></div> -->
	<!-- <div id="states" style="display: none;"></div> -->

	<script type="text/template" id="template_statistics">
		<div class="eight wide column">
			<div class="ui stacked center aligned segment">
				<div class="ui statistic">
					<div class="value">
						<%- statistics.count %> / <%- statistics.tested %>
					</div>
					<div class="label">
						Total elements / Tested
					</div>
				</div>
			</div>
		</div>
		<div class="eight wide column">
			<div class="ui stacked center aligned segment">
				<div class="ui statistic">
					<div class="value">
						<%- statistics.percentage %>%
					</div>
					<div class="label">
						Coverage
					</div>
				</div>
			</div>
		</div>
	</script>

	<script type="text/template" id="template_statistics_types">
		<div class="sixteen wide column">
			<% _.each(types, function(type, index) { %>
				<h5 class="ui attached header <% if(index == 0) print('top') %>">
				  <%- type.type %>
				</h5>
				<div class="ui <% if(index == types.length - 1) print ('bottom') %> attached segment">
					Count: <%- type.count %>, 
					Tested: <%- type.tested %>,
					Percentage: <%- type.percentage %>%
				</div>
			<% }); %>
		</div>
	</script>

	<script type="text/template" id="template_types">
		<h1 onClick="toggleTypes(this)">Project config</h1>
		<div class="types" style="display: none;">
			<% _.each(types, function(type) { %>
				<div class="type">
					<h3>
						Type: <%- type.type %> <br>
						Events: 
						<% _.each(type.events, function(event) { %>
							<%- event %>, 
						<% }); %>
					</h3>
				</div>
			<% }); %>
		</div>
	</script>

	<script type="text/template" id="template_states">

		<div class="sixteen wide column">
			<div class="ui styled fluid accordion">
				<% _.each(states, function(state) { %>
				  <div class="title">
						<h3>
							<i class="dropdown icon"></i>
							<%- state.url %><br>
							Elements: <%- state.count.seen %>, 
							Elements tested here: <%- state.count.tested %>, 
							Elements tested global: <%- state.count.tested_global %> <br>
							Percentage here: <%- state.percentage.here %>%, 
							Percentage global: <%- state.percentage.global %>%
						</h3>
				  </div>
				  <div class="content">
						<div class="ui hidden divider"></div>
						<h3>Statistics per type</h3>			
						<table class="ui table">
						  <thead>
						    <tr>
						      <th>Type</th>
						      <th>Count</th>
						      <th>Visited here (%)</th>
						      <th>Visited global (%)</th>
						    </tr>
						  </thead>
						  <tbody>
								<% _.each(state.types, function(type) { %>
									<tr>
										<td><%- type.type %></td>
										<td><%- type.seen %></td>
										<td><%- type.here %> (<%- type.percentage_here %>%)</td>
										<td><%- type.global %> (<%- type.percentage_global %>%)</td>
									</tr>
								<% }); %>
						  </tbody>
						</table>

						<div class="ui hidden divider"></div>
						<h3>Elements</h3>		

						<div class="ui divided very relaxed list">
							<% _.each(state.elements, function(elem) { %>
							  <div class="item">
									<% if(elem.tested) { %>
										<i class="icon green checkmark"></i>
									<% } else { %>
										<i class="icon red remove"></i>
									<% } %>
							    <div class="content" onClick="toggleElement(this, '.segment')">
							      <div class="header"><%- elem.type %></div>
										Tested: <%- elem.tested %>,
										Percentage here <strong><%- elem.percentage.here %></strong>%, 
										Percentage global <strong><%- elem.percentage.global %></strong>%
							    </div>
									<div class="ui segment" style="display: none;">
										<div class="ui top attached secondary segment">
											<code><%- elem.element %></code>
										</div>
										<div class="ui bottom attached segment">
								      <a class="ui label pointing right">Hash</a>
											<%- elem.hash %>
										</div>

										<h4>Events here</h4>

										<div class="ui two column stackable grid segment">
										  <div class="column">
										  	<div class="ui top left attached label">Tested</div>
												<% _.each(elem.events, function(event) { %>
										    	<div class="ui green horizontal label"><%- event %></div>
												<% }); %>
										  </div>
										  <div class="column">
										  	<div class="ui top left attached label">Not tested</div>
												<% _.each(elem.eventsStats.unseen, function(event) { %>
										    	<div class="ui red horizontal label"><%- event %></div>
												<% }); %>
										  </div>
										</div>

										<h4>Events global</h4>
										<div class="ui two column stackable grid segment">
										  <div class="column">
										  	<div class="ui top left attached label">Tested</div>
												<% _.each(elem.eventsStats.seen_global, function(event) { %>
										    	<div class="ui green horizontal label"><%- event %></div>
												<% }); %>
										  </div>
										  <div class="column">
										  	<div class="ui top left attached label">Not tested</div>
												<% _.each(elem.eventsStats.unseen_global, function(event) { %>
										    	<div class="ui red horizontal label"><%- event %></div>
												<% }); %>
										  </div>
										</div>

									</div>
							  </div>
						  <% }); %>
						</div>
				  </div>
			  <% }); %>
			</div>
		</div>
	</script>

	<script type="text/template" id="config"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
	<script src="accordion.js"></script>
	<script src="script.js"></script>
</body>
</html>